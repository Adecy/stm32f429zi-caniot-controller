# https://docs.zephyrproject.org/latest/reference/kconfig/index-all.html

####################################################

# GENERAL

# fs function needs a lot of stack/ram in general
CONFIG_MAIN_STACK_SIZE=2048

# https://docs.zephyrproject.org/latest/reference/kernel/threads/workqueue.html#configuration-options
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=1024
CONFIG_SYSTEM_WORKQUEUE_PRIORITY=-1
CONFIG_SYSTEM_WORKQUEUE_NO_YIELD=n

CONFIG_INIT_STACKS=y

CONFIG_ENTROPY_GENERATOR=y
CONFIG_TEST_RANDOM_GENERATOR=y
CONFIG_TIMEOUT_64BIT=y

CONFIG_POSIX_API=y
CONFIG_MINIMAL_LIBC=y
CONFIG_MINIMAL_LIBC_MALLOC=y
CONFIG_MINIMAL_LIBC_MALLOC_ARENA_SIZE=256

####################################################

# LOGGING
# https://docs.zephyrproject.org/latest/reference/logging/index.html
CONFIG_LOG=y
CONFIG_PRINTK=y

# CONFIG_LOG_STRDUP_MAX_STRING=48
# CONFIG_LOG_STRDUP_BUF_COUNT=42
# CONFIG_LOG_BUFFER_SIZE=2048
# CONFIG_LOG_MODE_DEFERRED=n

# set to immediate for debugging
CONFIG_LOG_MODE_IMMEDIATE=y

####################################################

# DEBUG
CONFIG_ASSERT=n

CONFIG_THREAD_MONITOR=n

# https://docs.zephyrproject.org/latest/guides/flash_debug/thread-analyzer.html
# -> disable CONFIG_LOG_MODE_IMMEDIATE when using THREAD analyser
CONFIG_THREAD_ANALYZER=n            
CONFIG_THREAD_NAME=y
CONFIG_THREAD_ANALYZER_USE_PRINTK=n
CONFIG_THREAD_ANALYZER_USE_LOG=y
CONFIG_THREAD_ANALYZER_AUTO=y
CONFIG_THREAD_ANALYZER_AUTO_INTERVAL=10
# THREAD_ANALYZER_AUTO_STACK_SIZE
CONFIG_THREAD_RUNTIME_STATS=y

####################################################

CONFIG_NETWORKING=y
CONFIG_NET_UDP=y
CONFIG_NET_TCP=y

CONFIG_ETH_STM32_HAL_RANDOM_MAC=n
CONFIG_ETH_STM32_HAL_MAC3=77
CONFIG_ETH_STM32_HAL_MAC4=77
CONFIG_ETH_STM32_HAL_MAC5=77

CONFIG_NET_IPV4=y
CONFIG_NET_IPV6=n
CONFIG_NET_TCP=y
CONFIG_NET_ARP=y
CONFIG_NET_UDP=y
CONFIG_NET_SHELL=n

CONFIG_NET_MGMT=y
CONFIG_NET_MGMT_EVENT=y

CONFIG_NET_SOCKETS=y
CONFIG_NET_SOCKETS_POLL_MAX=5

# https://github.com/zephyrproject-rtos/zephyr/issues/39705
CONFIG_NET_SOCKETS_POSIX_NAMES=y

CONFIG_NET_BUF_DATA_SIZE=128
CONFIG_NET_BUF_RX_COUNT=36
CONFIG_NET_BUF_TX_COUNT=36

# not entropy in delay
CONFIG_NET_DHCPV4=y
CONFIG_NET_DHCPV4_INITIAL_DELAY_MAX=2
CONFIG_NET_DHCPV4_LOG_LEVEL_DBG=n

CONFIG_DNS_RESOLVER=y
# CONFIG_DNS_RESOLVER_ADDITIONAL_BUF_CTR=5
# CONFIG_DNS_RESOLVER_ADDITIONAL_QUERIES=2
# CONFIG_MDNS_RESOLVER=y
# CONFIG_LLMNR_RESOLVER=n
# CONFIG_DNS_RESOLVER_MAX_SERVERS=2
# CONFIG_DNS_SERVER_IP_ADDRESSES=y
# CONFIG_DNS_NUM_CONCUR_QUERIES=5

# Config SNTP
CONFIG_SNTP=y
CONFIG_SNTP_LOG_LEVEL_DBG=n

CONFIG_NET_LOG=y
CONFIG_NET_IF_LOG_LEVEL_INF=y
CONFIG_NET_SOCKETS_LOG_LEVEL_DBG=n
CONFIG_NET_TCP_LOG_LEVEL_DBG=n
CONFIG_NET_CONFIG_LOG_LEVEL_DBG=y
CONFIG_NET_L2_ETHERNET_LOG_LEVEL_INF=y

CONFIG_NET_CONFIG_SETTINGS=n
CONFIG_NET_CONFIG_AUTO_INIT=n
CONFIG_NET_CONFIG_CLOCK_SNTP_INIT=n
CONFIG_NET_CONFIG_NEED_IPV6=n
CONFIG_NET_CONFIG_NEED_IPV4=n

CONFIG_NET_MAX_CONN=7
CONFIG_NET_MAX_CONTEXTS=7
CONFIG_POSIX_MAX_FDS=8
CONFIG_NET_SOCKETS_POLL_MAX=5

# https://docs.zephyrproject.org/latest/reference/kconfig/CONFIG_NET_TCP_TIME_WAIT_DELAY.html#std-kconfig-CONFIG_NET_TCP_TIME_WAIT_DELAY
# free TCP context immediately when closed
CONFIG_NET_TCP_TIME_WAIT_DELAY=0

# https://docs.zephyrproject.org/latest/reference/kconfig/CONFIG_NET_TCP_BACKLOG_SIZE.html#std-kconfig-CONFIG_NET_TCP_BACKLOG_SIZE
CONFIG_NET_TCP_BACKLOG_SIZE=3

####################################################

CONFIG_CAN=y
CONFIG_CAN_INIT_PRIORITY=80
CONFIG_CAN_MAX_FILTER=5

# this is default
CONFIG_CAN_LOOPBACK_TX_MSGQ_SIZE=16
CONFIG_CAN_LOOPBACK_TX_THREAD_PRIORITY=2
CONFIG_CAN_LOOPBACK_TX_THREAD_STACK_SIZE=256

CONFIG_CAN_LOG_LEVEL_DBG=n
CONFIG_CAN_LOOPBACK=n

####################################################

CONFIG_BOOTLOADER_MCUBOOT=n

# use code partition defined in the .overlay files
CONFIG_USE_DT_CODE_PARTITION=y

####################################################

CONFIG_MPU_ALLOW_FLASH_WRITE=y

CONFIG_FLASH=y
CONFIG_FLASH_MAP=y

CONFIG_FLASH_PAGE_LAYOUT=y

# Enabling shell, disables logs
# CONFIG_SHELL=y
# CONFIG_FLASH_SHELL=y

####################################################

CONFIG_GPIO=y

####################################################

CONFIG_HTTP_PARSER=y
CONFIG_JSON_LIBRARY=y